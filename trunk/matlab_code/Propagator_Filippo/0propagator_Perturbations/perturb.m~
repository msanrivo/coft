%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
%
% PERTURB.M
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% function pacc = perturb( t, x, pforce ) 
% 
% This function computes the acceleration due to perturbation forces
% (other different from main gravitational term) 
%
% Author: Paloma Belen Mangas Carbajo      
%
% 
% Input:
%
%       t       [1x1]   time, independent variable
%	x       [6x1]   state: position and velocity vector in cartesian
%       pforce          vector of handles of the perturbative forces
%       		   
% Output:
%
%       pacc    [3x1]   perrturbing acceleration vector in cartesian
% 
%
% Version: 1.0 28/06/2013
%          2.0 10/08/2013 Change in input and output of the functions
%                         vector of handles instead of flags 
%
%
function pacc = perturb( t, x, pforce )

R=6378145;

r3=(norm(x(1:3)))^3;
r=(norm(x(1:3)));
%
% Initialization.
%
pacc = zeros([3,1]); 
%
% Loop: call to functions that compute perturbing forces 
%
for ii = 1:length( pforce )
	   pacc = pacc + pforce{ii}( t , x )
end
%
return
